// This 365 Defender advanced hunting query detects CISA Known Exploited Vulnerabilities (KEV) based on the current catalog
// CISA KEV Catalog https://www.cisa.gov/known-exploited-vulnerabilities-catalog
//
// Grab the current CISA KEV list, create a variable
let CISAkev= externaldata(cveID:string)
                   ["https://www.cisa.gov/sites/default/files/csv/known_exploited_vulnerabilities.csv"]
                   with(format="csv");
// Use DeviceTvmSoftwareVulnerabilitiesKB table for the search
DeviceTvmSoftwareVulnerabilitiesKB
| where CveId in(CISAkev)
| join DeviceTvmSoftwareVulnerabilities on CveId
// Exclude some column noise
| project-away CveId1, VulnerabilitySeverityLevel1, AffectedSoftware, CveTags, DeviceId, OSArchitecture
// Sort Output by DeviceName
| sort by DeviceName asc
